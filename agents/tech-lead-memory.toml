[meta]
agent = "tech-lead-architect"
updated = 2025-08-20
sprint = "7+ Complete"
role = "Technical Architecture & Strategy"

[patterns]
# Sprint 6+ architectural patterns
architecture = "Direct Clerk hooks eliminate state complexity"
ux_pattern = "ClerkLoading/ClerkLoaded prevents FOUC"
api_design = "Server-side Clerk client for user extraction"
database = "Bootstrap pattern syncs Clerk â†’ Supabase reliably"
validation = "E2E testing reveals gaps agent reports miss"

[metrics]
# Architecture health metrics
tech_debt = "minimal"
complexity_score = "reduced 40%"
api_latency = "< 200ms"
build_time = "< 30s"

[stack]
frontend = ["next.js 15.4.6", "react 19", "typescript 5.x"]
backend = ["supabase", "clerk", "netlify-functions"]
infrastructure = ["netlify", "github-actions", "automatic-deployment"]
deployment = ["push-to-main", "4-minute-cycle", "production-parity-validated"]

[decisions]
sprint6 = ["Next.js App Router over Pages", "Clerk over custom auth", "TOML for agent memories"]
sprint5 = ["Vanilla scaffold first approach validated", "Incremental migration successful"]

[principles]
core = ["Evidence over reports", "Validation at every step", "User data from source of truth"]
quality = ["0 errors baseline", "E2E testing mandatory", "TypeScript strict mode"]

[next]
architecture = ["Event-driven sync pattern", "WebSocket for real-time"]
priority = "Sprint 8 codebase cleanup and security hardening"

[cleanup_analysis]
# Sprint 8 discovery findings
date = "2025-08-22"
legacy_files = ["2,503 lines of vanilla JS in packages/web/src/", "35+ duplicate files src/ vs packages/extension/"]
security_issues = ["511 console.log statements", "95 innerHTML usage", "XSS vulnerabilities"]
build_duplication = ["vite.config.js manages 3 targets", "src/ and packages/extension/ identical"]
secrets_status = ["git history shows secret cleanup commits", "no hardcoded secrets found in current state"]

[architecture_debt]
# Current technical debt requiring Sprint 8 cleanup
duplicate_builds = "src/ directory mirrors packages/extension/ exactly"
legacy_web = "packages/web/src/ contains 2,503 lines of deprecated vanilla JS"
security_surface = "innerHTML usage creates XSS vulnerabilities in production"
production_logs = "console.log statements leak to production builds"
build_complexity = "vite.config.js manages extension/web/shared with complex switching logic"