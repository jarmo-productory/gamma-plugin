(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function o(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(e){if(e.ep)return;e.ep=!0;const i=o(e);fetch(e.href,i)}})();function m(r){const n=String(r.getHours()).padStart(2,"0"),o=String(r.getMinutes()).padStart(2,"0");return`${n}:${o}`}function f(r){const[n,o]=r.split(":").map(Number),t=new Date;return t.setHours(n,o,0,0),t}function p(r,n={}){const{startTime:o="09:00",defaultDuration:t=5}=n,e=[];let i=f(o),s=0;return r.forEach(c=>{const a=new Date(i),d=t;i.setMinutes(i.getMinutes()+d),s+=d,e.push({id:c.id,title:c.title,content:c.content,startTime:m(a),duration:d,endTime:m(i)})}),{startTime:o,items:e,totalDuration:s}}function h(r){let n=`Item,Start Time,Duration (min),End Time
`;return r.items.forEach(o=>{const t=o.title.replace(/"/g,'""');n+=`"${t}",${o.startTime},${o.duration},${o.endTime}
`}),n}function g(r,n,o="text/csv;charset=utf-8;"){const t=new Blob([n],{type:o}),e=document.createElement("a"),i=URL.createObjectURL(t);e.setAttribute("href",i),e.setAttribute("download",r),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)}const b="0.1.0";let l=!1,u=[];function y(r=[]){const n=r.length;let o=r[0]?JSON.stringify(r[0],null,2):"N/A";return`
    <div class="debug-info">
      <strong>Debug Info</strong><br>
      Slides Detected: <strong>${n}</strong><br>
      Connected: <span style="color:${l?"green":"red"};font-weight:bold;">${l?"Yes":"No"}</span><br>
      <details><summary>First Slide Preview</summary><pre>${o}</pre></details>
    </div>
  `}function E(r=[]){const n=document.getElementById("sidebar-main");if(!n)return;n.innerHTML="";const o=document.createElement("button");o.id="generate-btn",o.textContent="Generate Timetable",o.onclick=()=>{const e=p(u);T(e)},n.appendChild(o);const t=document.createElement("div");t.id="slide-list",n.appendChild(t),r.length?r.forEach(e=>{const i=document.createElement("div");i.className="slide-item";const s=document.createElement("h3");s.className="slide-item__title",s.textContent=e.title||"(Untitled Slide)";const c=document.createElement("ul");c.className="slide-item__content",e.content.forEach(a=>{const d=document.createElement("li");d.textContent=a,c.appendChild(d)}),i.appendChild(s),i.appendChild(c),t.appendChild(i)}):t.innerHTML="<p>No slides found on the current page.</p>"}function T(r){const n=document.getElementById("sidebar-main");if(!n)return;const o=document.createElement("h3");o.innerHTML=`Timetable (Total: ${r.totalDuration} mins)`;const t=document.createElement("button");t.id="export-btn",t.textContent="Export to CSV",t.onclick=()=>{const e=h(r),i=`gamma-timetable-${new Date().toISOString().slice(0,10)}.csv`;g(i,e)},n.innerHTML="",n.appendChild(o),n.appendChild(t),r.items.forEach(e=>{const i=document.createElement("div");i.className="slide-item",i.innerHTML=`
      <div style="display: flex; justify-content: space-between; align-items: baseline;">
        <h3 class="slide-item__title">${e.title}</h3>
        <span style="font-size: 12px; color: #6b7280;">${e.startTime} - ${e.endTime} (${e.duration}m)</span>
      </div>
    `,n.appendChild(i)})}document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("version-display"),n=document.getElementById("sidebar-footer");r&&(r.textContent=`v${b}`);const o=(t=[])=>{u=t||[],E(u),n&&(n.innerHTML=y(t))};chrome.runtime.sendMessage({type:"REQUEST_GAMMA_SLIDES"},t=>{l=!0,o(t==null?void 0:t.slides)}),chrome.runtime.onMessage.addListener((t,e,i)=>{t.type==="GAMMA_SLIDES"&&Array.isArray(t.slides)&&(l=!0,o(t.slides))})});
